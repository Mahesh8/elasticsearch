<h1>Document Search</h1>

<%= form_for search_path, method: :get do |f| %>
  <p>
    <%= f.label "Search for" %>
    <%= text_field_tag :query, params[:query] %>
    <%= submit_tag "Go", name: nil %>
  </p>
<% end %>

<% if @documents %>
  <ul class="search_results">
    <% @documents.each do |document| %>
      <li>
           <h3>
              <%= link_to document.try(:highlight).try(:name) ?
                  document.highlight.name[0].html_safe : document.name,
                  controller: "documents", action: "show", id: document._id %>
                 
            </h3>
            <% if document.try(:highlight).try(:service) %>
              <% document.highlight.service.each do |snippet| %>
              <p><%= snippet.html_safe %>...</p>
            <% end %>
            <% end %>
      </li>
     
    <% end %>
  </ul>
<% else %>
  <p>Your search did not match any documents.</p>
<% end %>
<br/>

<%= link_to "Documents", documents_path %>

